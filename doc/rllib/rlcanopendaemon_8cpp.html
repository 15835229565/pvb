<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>rllib: rlcanopendaemon.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">rllib
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rlcanopendaemon.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="rlcanopendaemon_8h_source.html">rlcanopendaemon.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for rlcanopendaemon.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="rlcanopendaemon_8cpp__incl.png" border="0" usemap="#rlcanopendaemon_8cpp" alt=""/></div>
<map name="rlcanopendaemon_8cpp" id="rlcanopendaemon_8cpp">
<area shape="rect" id="node3" href="rlcanopendaemon_8h.html" title="rlcanopendaemon.h" alt="" coords="459,83,592,112"/><area shape="rect" id="node11" href="rlthread_8h.html" title="rlthread.h" alt="" coords="451,160,525,189"/><area shape="rect" id="node18" href="rlwthread_8h.html" title="rlwthread.h" alt="" coords="352,237,437,267"/><area shape="rect" id="node28" href="rlcutil_8h.html" title="rlcutil.h" alt="" coords="2199,160,2263,189"/><area shape="rect" id="node35" href="rlsocket_8h.html" title="rlsocket.h" alt="" coords="549,469,627,499"/><area shape="rect" id="node39" href="rlcanopen_8h.html" title="rlcanopen.h" alt="" coords="609,160,697,189"/><area shape="rect" id="node13" href="rldefine_8h.html" title="rldefine.h" alt="" coords="627,547,701,576"/><area shape="rect" id="node42" href="rlcannode_8h.html" title="rlcannode.h" alt="" coords="1241,237,1329,267"/><area shape="rect" id="node55" href="rlcanopenstructs_8h.html" title="rlcanopenstructs.h" alt="" coords="1597,315,1725,344"/><area shape="rect" id="node57" href="rlcanopentypes_8h.html" title="rlcanopentypes.h" alt="" coords="1888,315,2008,344"/><area shape="rect" id="node60" href="rlinifile_8h.html" title="rlinifile.h" alt="" coords="876,392,945,421"/><area shape="rect" id="node63" href="rlstring_8h.html" title="rlstring.h" alt="" coords="900,469,972,499"/></map>
</div>
</div>
<p><a href="rlcanopendaemon_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a51ba1765537b52ff4795f6ef0424c690"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#a51ba1765537b52ff4795f6ef0424c690">sdo_read</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:addf026270ccb455ee80506d5126ca7a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#addf026270ccb455ee80506d5126ca7a9">sdo_write</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:af71b281a73ea060f938e95273f4ddaa1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#af71b281a73ea060f938e95273f4ddaa1">pdo_receive</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:a3d493df597bef31c9bc2654f4bf7d686"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#a3d493df597bef31c9bc2654f4bf7d686">pdo_transmit</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:a75b08553e4d75c2dc274c9e0f293beab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#a75b08553e4d75c2dc274c9e0f293beab">nmt_transmit</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:ac49104ffe6f20c359102f1912dddc2fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#ac49104ffe6f20c359102f1912dddc2fe">restart_board</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:a4d2f8b22b9767bc7b85e24232fcaa76a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#a4d2f8b22b9767bc7b85e24232fcaa76a">getNodeState</a> (<a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *_daemonptr, <a class="el" href="classrlSocket.html">rlSocket</a> *_socket, <a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *_message)</td></tr>
<tr class="memitem:a78046224bc0729596e1af0c721acad79"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#a78046224bc0729596e1af0c721acad79">clientconnection</a> (void *arg)</td></tr>
<tr class="memitem:a5f85429028b201fd3ae153c19073e5ac"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rlcanopendaemon_8cpp.html#a5f85429028b201fd3ae153c19073e5ac">listenerthread</a> (void *arg)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a78046224bc0729596e1af0c721acad79"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* clientconnection </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>handels a new client connection established by listener thread. Saves socket descriptor in new socket object. Runs a loop which reads IPCMSGSTRUCTs containing client requests and calls appropiate handler functions which communicate with the canopen device and send answers back to the client. clientconnection Thread is terminated when client disconnects. </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00172">172</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="comment">//cout&lt;&lt;&quot;\n client connection established...\n&quot;;</span></div>
<div class="line">  </div>
<div class="line">  <a class="code" href="classrlCanOpenTypes.html" title="class to handle CANopen types">rlCanOpenTypes</a> cifmsg;</div>
<div class="line">  <a class="code" href="structTHREAD__PARAM.html">THREAD_PARAM</a> *p = (<a class="code" href="structTHREAD__PARAM.html">THREAD_PARAM</a> *) arg;</div>
<div class="line">  <a class="code" href="structTHREADTRANSFER.html">THREADTRANSFER</a> *tr = (<a class="code" href="structTHREADTRANSFER.html">THREADTRANSFER</a>*)p-&gt;<a class="code" href="structTHREAD__PARAM.html#abb08567308ed25b8bd3329ae84279b3d">user</a>;</div>
<div class="line">  <a class="code" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> message;</div>
<div class="line">  <span class="keywordtype">int</span> socketdescr = tr-&gt;<a class="code" href="structTHREADTRANSFER.html#a030472e2b2f26d19e79a38a6597d4f60">socketdescr</a>;</div>
<div class="line">  <a class="code" href="classrlCanOpenDaemon.html" title="canopen tcp/ip interface for concurrent device-access of multiple clientprocesses">rlCanOpenDaemon</a> *daemonptr = tr-&gt;<a class="code" href="structTHREADTRANSFER.html#a2d180c880175d6b3d4a98ad5114d6baf">daemonptr</a>;</div>
<div class="line">  <span class="keywordtype">int</span> ret;</div>
<div class="line">  <a class="code" href="classrlSocket.html">rlSocket</a> socket(socketdescr);</div>
<div class="line">  </div>
<div class="line">  <a class="code" href="rlcutil_8cpp.html#a5380bd2e87ffcf0c8a24c387b0ac7b7b">rlDebugPrintf</a>(<span class="stringliteral">&quot;client connection established...\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">while</span>(socket.isConnected())</div>
<div class="line">  {</div>
<div class="line">    ret = socket.read((<span class="keywordtype">void</span>*) &amp;message, <span class="keyword">sizeof</span>(message));</div>
<div class="line">    <span class="keywordflow">if</span>(ret &lt;= 0) <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a08c61a4cef5241dfb8d394e2c4889613">MSG_SDO_READ</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#a51ba1765537b52ff4795f6ef0424c690">sdo_read</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a39ace9ec46bece3742400a7c02854730">MSG_SDO_WRITE</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#addf026270ccb455ee80506d5126ca7a9">sdo_write</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1ae1f1be64e42d6e3a25c010e1dd335270">MSG_PDO_RECEIVE</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#af71b281a73ea060f938e95273f4ddaa1">pdo_receive</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1afedc0e794922c328a0156660e781f7c0">MSG_PDO_TRANSMIT</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#a3d493df597bef31c9bc2654f4bf7d686">pdo_transmit</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1ad29f36968c8e7abcbc93a045777c806e">MSG_NMT_TRANSMIT</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#a75b08553e4d75c2dc274c9e0f293beab">nmt_transmit</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1ab5afb59ae93d7d1d5e55f529b7fd37a2">MSG_RESTART_BOARD</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#ac49104ffe6f20c359102f1912dddc2fe">restart_board</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> ((message.msgtype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a1e3fa595af5b0fd8f36cd19503a982ef">MSG_GET_NODE_STATE</a>)&amp;&amp;(message.transfertype==<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1accbcc63bbba40481a04d655b0a97e359">MSG_SEND</a>)){</div>
<div class="line">      <a class="code" href="rlcanopendaemon_8cpp.html#a4d2f8b22b9767bc7b85e24232fcaa76a">getNodeState</a>(daemonptr, &amp;socket, &amp;message);</div>
<div class="line">    }    </div>
<div class="line">    </div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="rlcutil_8cpp.html#a5380bd2e87ffcf0c8a24c387b0ac7b7b">rlDebugPrintf</a>(<span class="stringliteral">&quot;client disconnect...\n&quot;</span>);</div>
<div class="line">  <span class="comment">//cout&lt;&lt;&quot;\n client disconnect...\n&quot;;</span></div>
<div class="line">  <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4d2f8b22b9767bc7b85e24232fcaa76a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getNodeState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a getNodeState command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00149">149</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                         {</div>
<div class="line">  <span class="keywordtype">int</span> returnvalue;</div>
<div class="line">  <a class="code" href="classrlCanOpenTypes.html" title="class to handle CANopen types">rlCanOpenTypes</a> cifmsg;</div>
<div class="line">  cifmsg.<a class="code" href="classrlCanOpenTypes.html#a9f3e044c60558bd0de010434241c9824" title="overwrites all data with IPCMSGSTRUCT data">getIpcMsg</a>(*_message);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#aef2160067fb768dc63c038fa0abc0f4d" title="use this function to get information about a specific node">getNodeState</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>,</div>
<div class="line">                                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                                cifmsg);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  *_message = cifmsg.<a class="code" href="classrlCanOpenTypes.html#af59141fc2073831833333cd48214d878" title="returns a IPCMSGSTRUCT filled with current object data">createIpcMsg</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a1e3fa595af5b0fd8f36cd19503a982ef">MSG_GET_NODE_STATE</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=returnvalue;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));   </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5f85429028b201fd3ae153c19073e5ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* listenerthread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>listenerthread waits for incoming client connections on the confugured port and spawns a new clientthread for each of them. </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00221">221</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// socketdescriptor;</span></div>
<div class="line">  <span class="keywordtype">int</span> socketdescr;</div>
<div class="line">  <span class="comment">// parameter struct for accessing function parameters</span></div>
<div class="line">  <a class="code" href="structTHREAD__PARAM.html">THREAD_PARAM</a> *p = (<a class="code" href="structTHREAD__PARAM.html">THREAD_PARAM</a> *) arg;</div>
<div class="line">  <span class="comment">// new parameter struct for passing parameters to handler thread</span></div>
<div class="line">  <a class="code" href="structTHREADTRANSFER.html">THREADTRANSFER</a> tr;</div>
<div class="line">  <a class="code" href="classrlCanOpenDaemon.html" title="canopen tcp/ip interface for concurrent device-access of multiple clientprocesses">rlCanOpenDaemon</a> *daemonptr = (<a class="code" href="classrlCanOpenDaemon.html" title="canopen tcp/ip interface for concurrent device-access of multiple clientprocesses">rlCanOpenDaemon</a>*) p-&gt;<a class="code" href="structTHREAD__PARAM.html#abb08567308ed25b8bd3329ae84279b3d">user</a>;</div>
<div class="line">  tr.<a class="code" href="structTHREADTRANSFER.html#a2d180c880175d6b3d4a98ad5114d6baf">daemonptr</a> = daemonptr;</div>
<div class="line">  <span class="keywordtype">int</span> port = daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a2700fe9d6dbf7950319ef744b391a527">getPort</a>();</div>
<div class="line">  <span class="comment">// wait for connections with accept();</span></div>
<div class="line">  <a class="code" href="rlcutil_8cpp.html#a5380bd2e87ffcf0c8a24c387b0ac7b7b">rlDebugPrintf</a>(<span class="stringliteral">&quot;\n starting listener on port %d...\n&quot;</span>, port);</div>
<div class="line">  <span class="comment">// initialize socket with daemonport</span></div>
<div class="line">  <a class="code" href="classrlSocket.html">rlSocket</a> s(<span class="stringliteral">&quot;localhost&quot;</span>,port,0);</div>
<div class="line">  <span class="comment">// listener main loop</span></div>
<div class="line">  <span class="keywordflow">while</span>(1){</div>
<div class="line">    socketdescr = s.connect();</div>
<div class="line">    <span class="keywordflow">if</span>(socketdescr == -1) <span class="keywordflow">break</span>;</div>
<div class="line">    tr.<a class="code" href="structTHREADTRANSFER.html#a030472e2b2f26d19e79a38a6597d4f60">socketdescr</a> = socketdescr;</div>
<div class="line">    daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a2e26bec1d1bc3bc35a3c8a1c9930f2fb">create</a>(<a class="code" href="rlcanopendaemon_8cpp.html#a78046224bc0729596e1af0c721acad79">clientconnection</a>, &amp;tr);</div>
<div class="line">    <span class="comment">// wait for clientconnection to save socketdescriptor</span></div>
<div class="line">    <a class="code" href="rlwthread_8cpp.html#a604b0dba29427e3514cd37136458e0c5">rlsleep</a>(100); </div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="rlcutil_8cpp.html#a5380bd2e87ffcf0c8a24c387b0ac7b7b">rlDebugPrintf</a>(<span class="stringliteral">&quot;\n killing listener...\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a75b08553e4d75c2dc274c9e0f293beab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nmt_transmit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a nmt_transmit command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00118">118</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                         {</div>
<div class="line">  <span class="keywordtype">char</span> returnvalue;</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#a3b59ba388442d8ccf33f0f031752f6cd" title="send a NMT Command to one or all nodes (of one board)">sendNMTCommand</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a85d3f9a8ebeece22a414750acb5906d6">mtext</a>[0]);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1afedc0e794922c328a0156660e781f7c0">MSG_PDO_TRANSMIT</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=returnvalue;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));   </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af71b281a73ea060f938e95273f4ddaa1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pdo_receive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a pdo_receive command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00058">58</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                        {</div>
<div class="line">  <span class="keywordtype">int</span> returnvalue;</div>
<div class="line">  <a class="code" href="classrlCanOpenTypes.html" title="class to handle CANopen types">rlCanOpenTypes</a> cifmsg;</div>
<div class="line">  cifmsg.<a class="code" href="classrlCanOpenTypes.html#a9f3e044c60558bd0de010434241c9824" title="overwrites all data with IPCMSGSTRUCT data">getIpcMsg</a>(*_message);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aed25748dde8a23b3527427ecf7d3f2e2">mappingid</a>==-1){</div>
<div class="line">      returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#a73a3479ae9754495e17aa6591dbf135e" title="using the pdo_receive function you can receive a mapped object within PDO">pdo_receive</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#af538071d5478f764a4782d39481ad5c6">pdoid</a>, </div>
<div class="line">                                                cifmsg);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#a73a3479ae9754495e17aa6591dbf135e" title="using the pdo_receive function you can receive a mapped object within PDO">pdo_receive</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#af538071d5478f764a4782d39481ad5c6">pdoid</a>, </div>
<div class="line">                                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aed25748dde8a23b3527427ecf7d3f2e2">mappingid</a>, </div>
<div class="line">                                                cifmsg);  </div>
<div class="line">    }</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  *_message = cifmsg.<a class="code" href="classrlCanOpenTypes.html#af59141fc2073831833333cd48214d878" title="returns a IPCMSGSTRUCT filled with current object data">createIpcMsg</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1ae1f1be64e42d6e3a25c010e1dd335270">MSG_PDO_RECEIVE</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=returnvalue;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));   </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d493df597bef31c9bc2654f4bf7d686"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pdo_transmit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a pdo_transmit command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00088">88</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                         {</div>
<div class="line">  <span class="keywordtype">int</span> returnvalue;</div>
<div class="line">  <a class="code" href="classrlCanOpenTypes.html" title="class to handle CANopen types">rlCanOpenTypes</a> cifmsg;</div>
<div class="line">  cifmsg.<a class="code" href="classrlCanOpenTypes.html#a9f3e044c60558bd0de010434241c9824" title="overwrites all data with IPCMSGSTRUCT data">getIpcMsg</a>(*_message);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aed25748dde8a23b3527427ecf7d3f2e2">mappingid</a>==-1){</div>
<div class="line">      returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#aa0af0f6576ec284128e9c3efb4770ca2" title="transmit a mapped object within a PDO to a specific node">pdo_transmit</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#af538071d5478f764a4782d39481ad5c6">pdoid</a>, </div>
<div class="line">                                                  cifmsg);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">      returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#aa0af0f6576ec284128e9c3efb4770ca2" title="transmit a mapped object within a PDO to a specific node">pdo_transmit</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#af538071d5478f764a4782d39481ad5c6">pdoid</a>, </div>
<div class="line">                                                  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aed25748dde8a23b3527427ecf7d3f2e2">mappingid</a>, </div>
<div class="line">                                                  cifmsg);  </div>
<div class="line">    }</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  *_message = cifmsg.<a class="code" href="classrlCanOpenTypes.html#af59141fc2073831833333cd48214d878" title="returns a IPCMSGSTRUCT filled with current object data">createIpcMsg</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1afedc0e794922c328a0156660e781f7c0">MSG_PDO_TRANSMIT</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=returnvalue;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));   </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac49104ffe6f20c359102f1912dddc2fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void restart_board </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a restartBoard command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00134">134</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                          {</div>
<div class="line">  <span class="keywordtype">char</span> returnvalue;</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    returnvalue=_daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#ac65b49a7d5677c354cd73c6980687219" title="using this function you are able to restart a CanOpenMaster board">restartBoard</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                                (<span class="keywordtype">int</span>) _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a85d3f9a8ebeece22a414750acb5906d6">mtext</a>[0]);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1afedc0e794922c328a0156660e781f7c0">MSG_PDO_TRANSMIT</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=returnvalue;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));   </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51ba1765537b52ff4795f6ef0424c690"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sdo_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a sdo_read command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00021">21</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                     {</div>
<div class="line">  <a class="code" href="classrlCanOpenTypes.html" title="class to handle CANopen types">rlCanOpenTypes</a> cifmsg;</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#a0a0e5e4328ff82cc5a7de3e8fa9c9713" title="read a certain object from the object dictionary of a node">sdo_read</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a1205d3341828bba91a988a38c6f98790">objectindex</a>, </div>
<div class="line">                                _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a84008b9e507ab525216cf0b0af900eed">subindex</a>, cifmsg);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  *_message = cifmsg.<a class="code" href="classrlCanOpenTypes.html#af59141fc2073831833333cd48214d878" title="returns a IPCMSGSTRUCT filled with current object data">createIpcMsg</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a08c61a4cef5241dfb8d394e2c4889613">MSG_SDO_READ</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a9a8b8c70e5e50e70a1dd8edfacea4da2">MSG_RECEIVE</a>;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="addf026270ccb455ee80506d5126ca7a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sdo_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classrlCanOpenDaemon.html">rlCanOpenDaemon</a> *&#160;</td>
          <td class="paramname"><em>_daemonptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classrlSocket.html">rlSocket</a> *&#160;</td>
          <td class="paramname"><em>_socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structIPCMSGSTRUCT.html">IPCMSGSTRUCT</a> *&#160;</td>
          <td class="paramname"><em>_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>gets called from clientconnection thread. performs a sdo_write command on the canopen interface. received data is stored in an <a class="el" href="structIPCMSGSTRUCT.html" title="the IPCMSGSTRUCT is the transfer buffer which is send trough TCP sockets">IPCMSGSTRUCT</a> and sent back to the clientprocess </p>

<p>Definition at line <a class="el" href="rlcanopendaemon_8cpp_source.html#l00039">39</a> of file <a class="el" href="rlcanopendaemon_8cpp_source.html">rlcanopendaemon.cpp</a>.</p>
<div class="fragment"><div class="line">                                      {</div>
<div class="line">  <a class="code" href="classrlCanOpenTypes.html" title="class to handle CANopen types">rlCanOpenTypes</a> cifmsg;</div>
<div class="line">  cifmsg.<a class="code" href="classrlCanOpenTypes.html#a9f3e044c60558bd0de010434241c9824" title="overwrites all data with IPCMSGSTRUCT data">getIpcMsg</a>(*_message);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#a543d60a27fdd4362af6a859049e19f52">lock</a>();</div>
<div class="line">    _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#ad32a3078d59a83504a752ced7bf9642c">nodes</a>-&gt;<a class="code" href="classrlCanOpen.html#afe214122e51cdd214d586ef1b50a5b34" title="write data into a certain object from the object dictionary of a node">sdo_write</a>(_message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a3e9d17de9492c78203c3ca6881faf6ab">boardid</a>, </div>
<div class="line">                                 _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a2acd50bbd96927117ea43f82e1fa8705">nodeid</a>, </div>
<div class="line">                                 _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a1205d3341828bba91a988a38c6f98790">objectindex</a>, </div>
<div class="line">                                 _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a84008b9e507ab525216cf0b0af900eed">subindex</a>, cifmsg);</div>
<div class="line">  _daemonptr-&gt;<a class="code" href="classrlCanOpenDaemon.html#a0ba207ed336015b1ec56340aa1ffebce">daemon_thread</a>.<a class="code" href="classrlThread.html#ab52388712ba58b879ea1f0ceca547ad3">unlock</a>();</div>
<div class="line">  *_message = cifmsg.<a class="code" href="classrlCanOpenTypes.html#af59141fc2073831833333cd48214d878" title="returns a IPCMSGSTRUCT filled with current object data">createIpcMsg</a>();</div>
<div class="line">  _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#a4c97b4f1dbf03de0358f3bc45ba527a0">msgtype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a39ace9ec46bece3742400a7c02854730">MSG_SDO_WRITE</a>; _message-&gt;<a class="code" href="structIPCMSGSTRUCT.html#aeabf16c705c41f39549f37b1341fcd40">transfertype</a>=<a class="code" href="rlcanopendaemon_8h.html#a84e97603720411166b6a7abf45a409f1a9a8b8c70e5e50e70a1dd8edfacea4da2">MSG_RECEIVE</a>;</div>
<div class="line">  _socket-&gt;<a class="code" href="classrlSocket.html#aa069e328b2509cbbc15bf9c91684b6be">write</a>((<span class="keywordtype">void</span>*) _message, <span class="keyword">sizeof</span>(*_message));   </div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
